'From Croquet1.0beta of 11 April 2006 [latest update: #1] on 18 June 2010 at 3:29:43 pm'!!QwaqParticipantUI methodsFor: 'initialize' stamp: 'bgf 6/17/2010 10:09'!serviceManagerProcess: manager forceChanges: bForce	"PRIVATE Stopabble worker script to initialize the service manager connection;	 see serviceManager: forceChanges: "	[		self assureOrgServices: manager.		bForce ifFalse: [			serviceMgr = manager ifTrue: [ ^ self ].		].		serviceMgr := manager.		manager ifNotNil: [manager resetQrl].		self clearDocumentManager.		manager ifNotNil: [			"We have the preferences cached from the provider, but - specifically for federated st.eu,			 we need to refresh the preferences each time we switch orgs."			self setupPreferences: ( QUserPreferences forUser: (login user value) inClient: self ) .			self initServerQPZMenu. "generate menus for all server-side Python apps"			self installServerPyLib.	   "install updated Python API library from server if required"		].		featureProperties := Dictionary new.		self updateUserRole.		"Do this now so all the tools and panes get the right info below."		"Set up the tools after org-services, because the tools use org-services."		self installServiceManager: manager.	] ifCurtailed: [		"(Not unexpected, but helpful when deciphering headless transcripts.)"		QLogger logInfo: 'Service Manager setup canceled.'.		(self propertyValueAt: #documentManager)			ifNotNilDo: [ : dm | dm destroy.						self removePropertyNamed: #documentManager ].	].! !!QServicesPane methodsFor: 'menus' stamp: 'bgf 6/14/2010 17:55'!entryForUrl: aURL	"Find the QServiceListEntry for the given forum URL "	^ allServices 		detect: [ :e| e url = aURL ] 		ifNone: [ 			aURL = '/lobby' ifFalse: [				QLogger logWarning: ('Fetch of unlisted Teleplace URL: ' , aURL) every: 60000.			].			nil 	]! !