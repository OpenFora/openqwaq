'From Croquet1.0beta of 11 April 2006 [latest update: #1] on 18 December 2009 at 10:31:24 am'!!QEditBox methodsFor: 'actions' stamp: 'bgf 12/18/2009 08:59'!scaleBox: event	"Called via perform for pointer-move events on the scale-corners."	| newScale pointer len1 len2 center notNormal ns |	pointer := event makePointer.	(pointer frame: self pickPlane: selectedPoint normal: selectedNormal) ifTrue:[		center := selectedPoint *selectedNormal.		len1 := (selectedPoint - center)length.		len1 = 0 ifTrue:[^ self].		len2 := (pointer selectedPoint - center)length.		newScale := len2/len1 +1.0/2.0.		newScale < 0.1 ifTrue:[newScale := 0.1].		ns := newScale * scaleFrame nominalScale.		"Guards against numeric freefall.."		ns < (baseScale *0.25) ifTrue:[^self].		ns > (baseScale *4.0) ifTrue:[^self].		"Detent at unit scale factors (especially useful for 1.0) "		event shiftPressed ifFalse: [			(ns - (ns rounded)) abs < 0.0125 ]  ifTrue: [				| detent |				detent := (ns rounded) / (scaleFrame nominalScale).				detent > (100*Float epsilon) ifTrue: [	"Don't even flirt with zero."					newScale := detent.				]].		event avatar 			cornerInfo: 'Scale: ',  ((newScale * scaleFrame nominalScale) roundTo: 0.001).		selectedPoint := selectedPoint * newScale.		notNormal := (selectedPoint - center)sign.		notNormal := notNormal-(notNormal * selectedNormal abs).		self translation: self translation + (self orientation transformPoint:(extent-(extent*newScale)*(selectedNormal-notNormal/2.0))).		self extent: extent * newScale.		scaleFrame nominalScale: scaleFrame nominalScale*newScale.		currentUser ifNotNil:[			currentUser users valuesDo:[:sel | 				sel userInfo ifNotNil:[					sel userInfo objectName = #scale ifTrue:[						sel userInfo							translation: sel frame translation.					].				].			].		].		self showGridForNormal: (selectedNormal) at: (self translation).	].! !!RFBClientPainter methodsFor: 'initialize' stamp: 'bgf 5/5/2009 20:20'!initialize	"Initial conditions."	super initialize.	isActive := false.	self clearVariables.	image := RFBClientForm extent: 0@0 depth: self class depth.	serverExtent := 0@0.	savedCursor := nil.	modifierState := 0.	creationTime := RealTime totalSeconds.  "for logging errors"	changed := false.	"For patch update to KeySym table.  	 1 is Home keyCode, 	 3 is Enter keyCode,	 +1 is KeySym table convention."	KeySyms at: 2 put: 16rFF50.	KeySyms at: 4 put: 16rFF0D.	! !